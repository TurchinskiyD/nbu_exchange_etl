SELECT
    ccy,
    exchangedate,
    rate,
    LAG(rate) OVER (PARTITION BY ccy ORDER BY exchangedate) AS prev_rate,
    rate - LAG(rate) OVER (PARTITION BY ccy ORDER BY exchangedate) AS rate_diff
FROM nbu.exchange_rates
WHERE exchangedate >= current_date - INTERVAL '3 days'
ORDER BY ccy, exchangedate;


ccy|exchangedate|rate     |prev_rate|rate_diff |
---+------------+---------+---------+----------+
AED|  2025-05-05|  11.3556|         |          |
AED|  2025-05-06|  11.3269|  11.3556|   -0.0287|
AED|  2025-05-07|  11.2863|  11.3269|   -0.0406|
AUD|  2025-05-05|  26.8294|         |          |
AUD|  2025-05-06|  26.9758|  26.8294|    0.1464|
AUD|  2025-05-07|  26.7837|  26.9758|   -0.1921|
AZN|  2025-05-05|  24.5362|         |          |
AZN|  2025-05-06|  24.4785|  24.5362|   -0.0577|
AZN|  2025-05-07|  24.3806|  24.4785|   -0.0979|
BDT|  2025-05-05|  0.34188|         |          |
BDT|  2025-05-06|  0.34101|  0.34188|  -0.00087|
BDT|  2025-05-07|  0.33979|  0.34101|  -0.00122|
BGN|  2025-05-05|   24.189|         |          |
BGN|  2025-05-06|  24.1264|   24.189|   -0.0626|
BGN|  2025-05-07|  24.0107|  24.1264|   -0.1157|
CAD|  2025-05-05|  30.1759|         |          |
CAD|  2025-05-06|  30.1475|  30.1759|   -0.0284|
CAD|  2025-05-07|  30.0296|  30.1475|   -0.1179|
CHF|  2025-05-05|  50.6455|         |          |
CHF|  2025-05-06|  50.5297|  50.6455|   -0.1158|
CHF|  2025-05-07|  50.2721|  50.5297|   -0.2576|
CNY|  2025-05-05|   5.7359|         |          |
CNY|  2025-05-06|   5.7214|   5.7359|   -0.0145|
CNY|  2025-05-07|   5.7438|   5.7214|    0.0224|
CZK|  2025-05-05|   1.8992|         |          |
CZK|  2025-05-06|   1.8946|   1.8992|   -0.0046|
CZK|  2025-05-07|   1.8816|   1.8946|   -0.0130|
DKK|  2025-05-05|   6.3407|         |          |
DKK|  2025-05-06|   6.3236|   6.3407|   -0.0171|
DKK|  2025-05-07|   6.2943|   6.3236|   -0.0293|
DZD|  2025-05-05|  0.31517|         |          |
DZD|  2025-05-06|  0.31401|  0.31517|  -0.00116|
DZD|  2025-05-07|  0.31292|  0.31401|  -0.00109|
EGP|  2025-05-05|   0.8212|         |          |
EGP|  2025-05-06|   0.8209|   0.8212|   -0.0003|
EGP|  2025-05-07|   0.8184|   0.8209|   -0.0025|
EUR|  2025-05-05|  47.3127|         |          |
EUR|  2025-05-06|  47.1868|  47.3127|   -0.1259|
EUR|  2025-05-07|  46.9637|  47.1868|   -0.2231|
GBP|  2025-05-05|  55.4335|         |          |
GBP|  2025-05-06|  55.3994|  55.4335|   -0.0341|
GBP|  2025-05-07|  55.4245|  55.3994|    0.0251|
GEL|  2025-05-05|  15.1796|         |          |
GEL|  2025-05-06|  15.1561|  15.1796|   -0.0235|
GEL|  2025-05-07|  15.1073|  15.1561|   -0.0488|
HKD|  2025-05-05|   5.3818|         |          |
HKD|  2025-05-06|   5.3681|   5.3818|   -0.0137|
HKD|  2025-05-07|    5.349|   5.3681|   -0.0191|
HUF|  2025-05-05| 0.117055|         |          |
HUF|  2025-05-06| 0.116667| 0.117055| -0.000388|
HUF|  2025-05-07|  0.11593| 0.116667| -0.000737|
IDR|  2025-05-05|0.0025372|         |          |
IDR|  2025-05-06|0.0025282|0.0025372|-0.0000090|
IDR|  2025-05-07|0.0025197|0.0025282|-0.0000085|
ILS|  2025-05-05|   11.555|         |          |
ILS|  2025-05-06|   11.507|   11.555|    -0.048|
ILS|  2025-05-07|  11.4657|   11.507|   -0.0413|
INR|  2025-05-05|  0.49353|         |          |
INR|  2025-05-06|   0.4936|  0.49353|   0.00007|
INR|  2025-05-07|  0.49084|   0.4936|  -0.00276|
JPY|  2025-05-05|  0.28855|         |          |
JPY|  2025-05-06|  0.28913|  0.28855|   0.00058|
JPY|  2025-05-07|  0.29023|  0.28913|   0.00110|
KRW|  2025-05-05| 0.029831|         |          |
KRW|  2025-05-06| 0.030379| 0.029831|  0.000548|
KRW|  2025-05-07| 0.030019| 0.030379| -0.000360|
KZT|  2025-05-05| 0.080721|         |          |
KZT|  2025-05-06| 0.080548| 0.080721| -0.000173|
KZT|  2025-05-07| 0.080561| 0.080548|  0.000013|
LBP|  2025-05-05| 0.000466|         |          |
LBP|  2025-05-06| 0.000465| 0.000466| -0.000001|
LBP|  2025-05-07| 0.000463| 0.000465| -0.000002|
MDL|  2025-05-05|   2.4214|         |          |
MDL|  2025-05-06|   2.4193|   2.4214|   -0.0021|
MDL|  2025-05-07|   2.4136|   2.4193|   -0.0057|
MXN|  2025-05-05|   2.1187|         |          |
MXN|  2025-05-06|    2.123|   2.1187|    0.0043|
MXN|  2025-05-07|   2.1015|    2.123|   -0.0215|
MYR|  2025-05-05|   9.7975|         |          |
MYR|  2025-05-06|   9.9044|   9.7975|    0.1069|
MYR|  2025-05-07|    9.795|   9.9044|   -0.1094|
NOK|  2025-05-05|    4.023|         |          |
NOK|  2025-05-06|   4.0072|    4.023|   -0.0158|
NOK|  2025-05-07|   4.0072|   4.0072|    0.0000|
NZD|  2025-05-05|  24.7794|         |          |
NZD|  2025-05-06|  24.8998|  24.7794|    0.1204|
NZD|  2025-05-07|  24.8022|  24.8998|   -0.0976|
PLN|  2025-05-05|  11.0696|         |          |
PLN|  2025-05-06|  11.0313|  11.0696|   -0.0383|
PLN|  2025-05-07|  10.9851|  11.0313|   -0.0462|
RON|  2025-05-05|    9.504|         |          |
RON|  2025-05-06|   9.4782|    9.504|   -0.0258|
RON|  2025-05-07|   9.2526|   9.4782|   -0.2256|
RSD|  2025-05-05|  0.40358|         |          |
RSD|  2025-05-06|  0.40255|  0.40358|  -0.00103|
RSD|  2025-05-07|  0.40059|  0.40255|  -0.00196|
SAR|  2025-05-05|  11.1221|         |          |
SAR|  2025-05-06|  11.0925|  11.1221|   -0.0296|
SAR|  2025-05-07|  11.0519|  11.0925|   -0.0406|
SEK|  2025-05-05|    4.323|         |          |
SEK|  2025-05-06|    4.318|    4.323|    -0.005|
SEK|  2025-05-07|   4.3102|    4.318|   -0.0078|
SGD|  2025-05-05|  32.1854|         |          |
SGD|  2025-05-06|  32.2759|  32.1854|    0.0905|
SGD|  2025-05-07|  32.1576|  32.2759|   -0.1183|
THB|  2025-05-05|  1.26219|         |          |
THB|  2025-05-06|   1.2647|  1.26219|   0.00251|
THB|  2025-05-07|  1.27013|   1.2647|   0.00543|
TND|  2025-05-05|  13.9776|         |          |
TND|  2025-05-06|  13.9161|  13.9776|   -0.0615|
TND|  2025-05-07|  13.8764|  13.9161|   -0.0397|
TRY|  2025-05-05|   1.0815|         |          |
TRY|  2025-05-06|   1.0782|   1.0815|   -0.0033|
TRY|  2025-05-07|   1.0738|   1.0782|   -0.0044|
USD|  2025-05-05|  41.7091|         |          |
USD|  2025-05-06|  41.6036|  41.7091|   -0.1055|
USD|  2025-05-07|  41.4544|  41.6036|   -0.1492|
VND|  2025-05-05|0.0016046|         |          |
VND|  2025-05-06|0.0016024|0.0016046|-0.0000022|
VND|  2025-05-07|0.0015962|0.0016024|-0.0000062|
XAG|  2025-05-05|  1347.25|         |          |
XAG|  2025-05-06|  1346.89|  1347.25|     -0.36|
XAG|  2025-05-07|  1371.99|  1346.89|     25.10|
XAU|  2025-05-05|136138.92|         |          |
XAU|  2025-05-06|137824.82|136138.92|   1685.90|
XAU|  2025-05-07|140070.27|137824.82|   2245.45|
XDR|  2025-05-05|  56.4683|         |          |
XDR|  2025-05-06|  56.3493|  56.4683|   -0.1190|
XDR|  2025-05-07|  56.2211|  56.3493|   -0.1282|
XPD|  2025-05-05| 39504.36|         |          |
XPD|  2025-05-06| 39958.18| 39504.36|    453.82|
XPD|  2025-05-07| 39511.85| 39958.18|   -446.33|
XPT|  2025-05-05| 40441.56|         |          |
XPT|  2025-05-06| 40119.18| 40441.56|   -322.38|
XPT|  2025-05-07| 40544.89| 40119.18|    425.71|
ZAR|  2025-05-05|    2.268|         |          |
ZAR|  2025-05-06|   2.2711|    2.268|    0.0031|
ZAR|  2025-05-07|   2.2706|   2.2711|   -0.0005|